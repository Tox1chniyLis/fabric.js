{"version":3,"file":"get-objects-by-target.mjs","sources":["../../../extensions/aligning_guidelines/util/get-objects-by-target.ts"],"sourcesContent":["import type { FabricObject } from 'fabric';\nimport { ActiveSelection, Group } from 'fabric';\n\nexport function getObjectsByTarget(target: FabricObject) {\n  const objects = new Set<FabricObject>();\n  const canvas = target.canvas;\n  if (!canvas) return objects;\n  const children =\n    target instanceof ActiveSelection ? target.getObjects() : [target];\n\n  canvas.forEachObject((o) => {\n    if (!o.isOnScreen()) return;\n    if (!o.visible) return;\n    if (o.constructor == Group) {\n      collectObjectsByGroup(objects, o);\n      return;\n    }\n    objects.add(o);\n  });\n\n  deleteObjectsByList(objects, children);\n  return objects;\n}\n\nfunction deleteObjectsByList(objects: Set<FabricObject>, list: FabricObject[]) {\n  for (const target of list) {\n    if (target.constructor == Group) {\n      deleteObjectsByList(objects, (target as Group).getObjects());\n    } else {\n      objects.delete(target);\n    }\n  }\n}\n\nfunction collectObjectsByGroup(objects: Set<FabricObject>, g: Group) {\n  const children = g.getObjects();\n  for (const child of children) {\n    if (!child.visible) continue;\n    if (child.constructor == Group) {\n      collectObjectsByGroup(objects, child);\n      continue;\n    }\n    objects.add(child);\n  }\n}\n"],"names":["getObjectsByTarget","target","objects","Set","canvas","children","ActiveSelection","getObjects","forEachObject","o","isOnScreen","visible","constructor","Group","collectObjectsByGroup","add","deleteObjectsByList","list","delete","g","child"],"mappings":";;AAGO,SAASA,kBAAkBA,CAACC,MAAoB,EAAE;AACvD,EAAA,MAAMC,OAAO,GAAG,IAAIC,GAAG,EAAgB;AACvC,EAAA,MAAMC,MAAM,GAAGH,MAAM,CAACG,MAAM;AAC5B,EAAA,IAAI,CAACA,MAAM,EAAE,OAAOF,OAAO;AAC3B,EAAA,MAAMG,QAAQ,GACZJ,MAAM,YAAYK,eAAe,GAAGL,MAAM,CAACM,UAAU,EAAE,GAAG,CAACN,MAAM,CAAC;AAEpEG,EAAAA,MAAM,CAACI,aAAa,CAAEC,CAAC,IAAK;AAC1B,IAAA,IAAI,CAACA,CAAC,CAACC,UAAU,EAAE,EAAE;AACrB,IAAA,IAAI,CAACD,CAAC,CAACE,OAAO,EAAE;AAChB,IAAA,IAAIF,CAAC,CAACG,WAAW,IAAIC,KAAK,EAAE;AAC1BC,MAAAA,qBAAqB,CAACZ,OAAO,EAAEO,CAAC,CAAC;AACjC,MAAA;AACF;AACAP,IAAAA,OAAO,CAACa,GAAG,CAACN,CAAC,CAAC;AAChB,GAAC,CAAC;AAEFO,EAAAA,mBAAmB,CAACd,OAAO,EAAEG,QAAQ,CAAC;AACtC,EAAA,OAAOH,OAAO;AAChB;AAEA,SAASc,mBAAmBA,CAACd,OAA0B,EAAEe,IAAoB,EAAE;AAC7E,EAAA,KAAK,MAAMhB,MAAM,IAAIgB,IAAI,EAAE;AACzB,IAAA,IAAIhB,MAAM,CAACW,WAAW,IAAIC,KAAK,EAAE;MAC/BG,mBAAmB,CAACd,OAAO,EAAGD,MAAM,CAAWM,UAAU,EAAE,CAAC;AAC9D,KAAC,MAAM;AACLL,MAAAA,OAAO,CAACgB,MAAM,CAACjB,MAAM,CAAC;AACxB;AACF;AACF;AAEA,SAASa,qBAAqBA,CAACZ,OAA0B,EAAEiB,CAAQ,EAAE;AACnE,EAAA,MAAMd,QAAQ,GAAGc,CAAC,CAACZ,UAAU,EAAE;AAC/B,EAAA,KAAK,MAAMa,KAAK,IAAIf,QAAQ,EAAE;AAC5B,IAAA,IAAI,CAACe,KAAK,CAACT,OAAO,EAAE;AACpB,IAAA,IAAIS,KAAK,CAACR,WAAW,IAAIC,KAAK,EAAE;AAC9BC,MAAAA,qBAAqB,CAACZ,OAAO,EAAEkB,KAAK,CAAC;AACrC,MAAA;AACF;AACAlB,IAAAA,OAAO,CAACa,GAAG,CAACK,KAAK,CAAC;AACpB;AACF;;;;"}